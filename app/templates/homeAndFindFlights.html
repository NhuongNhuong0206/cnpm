{% extends 'layout/base.html' %}

{% block title %}Trang chủ{% endblock %}

{% block content %}
<body onload="list_info()">
<h2 class="text-center fw-bold my-5">Tìm chuyến bay</h2>
<div class="justify-content-center row">
    <form method="post" action="/" class="w-50 my-auto p-4 bg-white shadow-lg rounded-1">
        <div class="d-flex gap-3">
            <div class="form-check">
                <label class="form-check-label" for="ticketType-1">
                    Vé một chiều
                </label>
            </div>
        </div>
        <div class="mt-2 ">
            <div>
                <label id="ap_from" for="ap_from" class="form-label">Từ:</label>
                <select name="from" class="form-select">
                    <option value="" selected></option>
                    {% for airport in airport_list %}
                    <option value="{{airport.id}}">{{ airport.name }}</option>
                    {% endfor %}
                </select>

            </div>

            <div>
                <label id="ap_to" for="ap_to" class="form-label">Đến:</label>
                <select name="to" class="form-select">
                    <option value="" selected></option>
                        {% for airport in airport_list %}
                        <option value="{{airport.id}}">{{ airport.name }}</option>
                        {% endfor %}
                </select>

            </div>
            <datalist id="airports"></datalist>
            <div class="mt-2 d-flex gap-3">
                <div class="flex-grow-1">
                    <label  for="departure_date" class="form-label">Ngày đi:</label>
                    <input id="departure_date"  class="form-control" {% if session['inp_search'] %} value="{{
                    session['inp_search'].time_start
                    }}" {% endif %} name="dayStart" id="time_start" type="date">
                </div>

                <div class="align-self-end">
                    <label for="ticket_type" class="form-label">Ghế:</label>
                    <select  id="ticket_type" name="rankChair" class="form-select">
                        <option {% if session[
                        'inp_search'] and session["inp_search"].ticket_type=="1" %}selected="selected"{% endif %}
                        value="1">Hạng Thương Gia</option>
                        <option {% if session[
                        'inp_search'] and session['inp_search'].ticket_type=="2" %}selected="selected"{% endif %}
                        value="2">Hạng Thường</option>
                    </select>
                </div>
            </div>
            <button  id="submit-btn"  value="-1" name='button' onclick="save()" type="submit" class="mt-4 w-100 btn btn-primary">Tìm chuyến bay
            </button>

            <h3 class="my-3">Vé phù hợp</h3>
            <table class="mt-4 table">
                <thead>
                <tr style="text_">
                    <th scope="col">Mã tuyến bay</th>
                    <th scope="col">Sân đi->sân đến</th>
                    <th scope="col">Sân trung gian</th>
                    <th scope="col">Thời gian xuất phát</th>
                    <th scope="col">Hạng ghế</th>
                    <th scope="col">Giá</th>
                    <th scope="col>">Chọn</th>
                </tr>
                </thead>
<!--                anh ơi em không làm được cái homeand á, cái trang home tìm kiếm load xong phải còn giữ lại thông tin, anh làm đi, em có ghi js-->
                <tbody>
                {% for tuyen in dstuyen %}
                <tr>
                    <th scope="col">{{tuyen.id}}</th>
                    <th scope="col">{{tuyen.name_flight_route}}</th>
                    <th scope="col" >{{airport_list[tuyen.bw_airport_id -1].name}}</th>
                    <th scope="col">{{flight_schedules[loop.index0].departure_time}}</th>
                    <th scope="col">
                        {% if rank_chair == "1"  %}
                        Hạng thương gia
                        {%else%}
                        Hạng thường
                        {% endif %}
                    </th>
                    <th scope="col" id="gia">
                        {% if rank_chair == "1"  %}
                        {{ tuyen.price + 200000}}
                        {%else%}
                        {{ tuyen.price}}
                        {% endif %}
                        VND
                    </th>

                    <th scope="col" class="center-vertically" >
                        <form method="post" action="">
                         <button  type="submit" value="{{ loop.index0 }}" name='button' class="btn btn-primary">Đặt Vé</button>
                        </form>
                    </th>
                </tr>
                {% endfor %}
                </tbody>
            </table>
    </form>
</div>
</div>
<!--<a href="{{ url_for('ticket') }}" class="btn btn-primary mt-4">Xem vé chuyến bay</a>-->
</body>
{% endblock %}
{% block js %}
<script src="{{ url_for('static', filename='js/homeAndFindFlights.js') }}"></script>
{% endblock %}
